os: linux
dist: bionic
language: cpp

# Compiler selection
compiler:
- gcc
- clang

install:
  - mkdir deps
  - cd deps
  - ../scripts/install-catch2.sh
  - pip install -r requirements.txt

# Build steps
script:
  - cd ${TRAVIS_BUILD_DIR}
  - python3 ./setup.py install --user
  - colorlib_gen -re --target "cpp" --enum-name "cl_colors" --function-name "cl_map" --config "./example_conf.yaml" "./tests/colorlib_map.hpp"
  - cd ${TRAVIS_BUILD_DIR}/tests
  - mkdir build
  - cd build
  - cmake .. && make
  - ctest
